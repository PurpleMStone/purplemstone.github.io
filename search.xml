<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title><![CDATA[æŽå¼˜æ¯…MLè¯¾ç¨‹ä½œä¸šä¸€ï¼šPM2.5çš„é¢„æµ‹]]></title>
    <url>%2F2020%2F03%2F18%2FML_HW1%2F</url>
    <content type="text"><![CDATA[1. ä½œä¸šæè¿°â€‹ ç»™å®šäº†è®­ç»ƒé›†train.csvï¼Œè¦æ±‚ç”¨å‰9å°æ—¶çš„æ•°æ®é¢„æµ‹å‡ºç¬¬åä¸ªå°æ—¶çš„PM2.5çš„å€¼ã€‚è¿™æ˜¯linear regressionçš„ä½œä¸šã€‚ 2. Feature Selectionâ€‹ train.csvä¸­æ¯ä¸ªå°æ—¶ç»™å‡ºäº†18ä¸ªç‰¹å¾ï¼Œå…¶å®žæœ‰äº›ç‰¹å¾ä¸ŽPM2.5å…³ç³»ä¸å¤§ã€‚é¦–å…ˆç”»ä¸€ä¸‹ç›¸å…³çŸ©é˜µçƒ­åŠ›å›¾æ¥è§‚å¯Ÿä¸€ä¸‹ã€‚ 123456789101112131415161718192021222324import numpy as npimport pandas as pddata=pd.read_csv('train.csv')data.drop(['a','b'],axis=1,inplace=True)column=data['c'].unique()data_new=pd.DataFrame(np.zeros([24*240,18]),columns=column)for i in column: aa=data[data['c']==i] aa.drop(['c'],axis=1,inplace=True) aa=np.array(aa) aa[aa=='NR']='0' aa=aa.astype('float32') aa=aa.reshape(1,5760) aa=aa.T data_new[i]=aalabel=np.array(data_new['PM2.5'][9:],dtype='float32')import matplotlib.pyplot as pltimport seaborn as sns# Draw a heatmap with the numeric values in each cellf, ax = plt.subplots(figsize=(9, 6))sns.heatmap(abs(data_new.corr()), fmt="d", linewidths=.5, ax=ax, cmap='Blues')f.savefig('heatmap.png') â€‹ è¿™é‡Œä¸å…³å¿ƒæ˜¯è´Ÿç›¸å…³è¿˜æ˜¯æ­£ç›¸å…³ï¼Œæ‰€ä»¥å¯¹ç›¸å…³çŸ©é˜µå–äº†ç»å¯¹å€¼ã€‚ç”»å‡ºæ¥çš„ç»“æžœæ˜¯è¿™æ ·çš„ï¼š å¯¹äºŽPM2.5æ¥è¯´ï¼Œç›¸å…³æ€§æ¯”è¾ƒé«˜çš„æœ‰NO2, NO1, NOx, SO2, THC, PM10ç­‰ç‰¹å¾ã€‚ â€‹ ä¹Ÿå¯ä»¥æŠŠæ¯ä¸ªç‰¹å¾ä¸ŽPM2.5çš„å…³ç³»ç»˜åˆ¶ä¸€ä¸‹ã€‚å¯ä»¥è§‚å¯Ÿåˆ°éƒ¨åˆ†ç‰¹å¾ä¸ŽPM2.5çš„å€¼å…³ç³»ä¸å¤§ã€‚ 3. Data Preprocessingâ€‹ è¿™é‡Œç”¨äº†ä½œä¸šdemoç»™å‡ºçš„æ–¹æ³•ã€‚æŠŠå‰9ä¸ªå°æ—¶çš„å…¨éƒ¨18ä¸ªç‰¹å¾éƒ½ä½œä¸ºé¢„æµ‹ç¬¬åå°æ—¶PM2.5çš„ç‰¹å¾ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œ(9*18+1) ä¸ªè¾“å…¥ç‰¹å¾ï¼ˆåŠ ä¸Šbiasï¼‰å¯¹åº”ä¸€ä¸ªè¾“å‡ºã€‚è¾“å…¥è¿›è¡Œäº†å½’ä¸€åŒ–ã€‚ 1234567891011121314151617181920212223242526272829data = pd.read_csv('../train.csv', encoding='big5')data = data.iloc[:, 3:]data[data == 'NR'] = 0raw_data = data.to_numpy()month_data = &#123;&#125;for month in range(12): sample = np.empty([18, 480]) for day in range(20): sample[:, day*24:(day+1)*24] = raw_data[18*(20*month+day):18*(20*month+day+1)] month_data[month] = samplex = np.empty([12*471, 18*9], dtype=float) # training datay = np.empty([12*471, 1], dtype=float) # training setfor month in range(12): for day in range(20): for hour in range(24): if day == 19 and hour &gt; 14: continue x[month*471+day*24+hour, :] = month_data[month][:, day*24+hour:day*24+hour+9].reshape(1,-1) y[month*471+day*24+hour, 0] = month_data[month][9, day*24+hour+9] #value# Normalizationmean_x = np.mean(x, axis=0)std_x = np.std(x, axis=0)for i in range(len(x)): for j in range(len(x[0])): if std_x[j] != 0: x[i][j] = (x[i][j] - mean_x[j]) / std_x[j] â€‹ å¤„ç†å®ŒåŽï¼Œå¼ é‡xå°±æ˜¯è¾“å…¥ï¼ˆå‰9å°æ—¶çš„æ‰€æœ‰ç‰¹å¾ï¼‰ï¼Œyå°±æ˜¯è¾“å‡ºï¼ˆç¬¬åå°æ—¶PM2.5å€¼ï¼‰ã€‚ 4. ç”¨ä¸åŒçš„å­¦ä¹ çŽ‡è®­ç»ƒ1234567891011121314151617181920212223242526# trainingdim = 18*9 + 1w = np.ones([dim, 1])x = np.concatenate((np.ones([12*471, 1]), x), axis = 1).astype(float)learning_rate = 100iter_time = 1000adagrad = np.zeros([dim, 1])eps = 1e-10training_loss = []for t in range(iter_time): loss = np.sqrt(np.sum(np.power(np.dot(x, w) - y, 2))/471/12) # rmse training_loss.append(loss) if t % 100 == 0: print(str(t)+":"+str(loss)) gradient = 2 * np.dot(x.transpose(), np.dot(x, w) - y) # dim*1 adagrad += gradient ** 2 w = w - learning_rate * gradient / np.sqrt(adagrad + eps)np.save('weight.npy', w)# Save loss datafileObject = open('lr_loss_'+str(learning_rate)+'.txt', 'w')for ip in training_loss: fileObject.write(str(ip)) fileObject.write('\n')fileObject.close() åœ¨ç›¸åŒçš„å‚æ•°ä¸‹ï¼Œåˆ†åˆ«ç”¨0.1ï¼Œ10ï¼Œ100ï¼Œ1000çš„å­¦ä¹ çŽ‡è®­ç»ƒï¼Œçœ‹ä¸€ä¸‹æ”¶æ•›çš„æ•ˆæžœã€‚å­¦ä¹ çŽ‡ä¸º0.1æ—¶æ”¶æ•›éžå¸¸æ…¢ï¼Œå­¦ä¹ çŽ‡å¤ªå¤§ï¼ˆå¦‚1000ï¼‰æ—¶åˆæ— æ³•æ”¶æ•›åˆ°æœ€å°å€¼ã€‚ æŽå¼˜æ¯…è€å¸ˆMLè¯¾ç¨‹ä¸»é¡µ correlation matrix heatmap reference]]></content>
      <tags>
        <tag>machine learning</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æˆ‘ä»¬çš„æ•…äº‹]]></title>
    <url>%2F2019%2F09%2F27%2F%E6%88%91%E4%BB%AC%E7%9A%84%E6%95%85%E4%BA%8B%2F</url>
    <content type="text"><![CDATA[1ä»–çªç„¶è¯´è¦æ¥çœ‹æ¨±èŠ±çš„æ—¶å€™ï¼Œæˆ‘çœŸçš„ä»¥ä¸ºä»–æ˜¯æ¥çœ‹èŠ±çš„ã€‚ è™½ç„¶åœ¨åŒä¸€åº§åŸŽå¸‚ï¼Œä½†æ˜¯æˆ‘ä»¬çš„è”ç³»å®žåœ¨å°‘çš„å¯æ€œã€‚æˆ‘æ—¶å¸¸å¿˜è®°ï¼Œåœ¨è¿™ä¸ªç¦»å®¶è¿‘ä¸€åƒå…¬é‡Œçš„åœ°æ–¹ï¼Œè¿˜æœ‰ä¸€ä¸ªåŒä¹¡çš„å­˜åœ¨ã€‚ç›´åˆ°ä»–è¯´ï¼Œ4å¹´äº†ï¼Œæ€»è¯¥æ¥ä½ çš„å­¦æ ¡çœ‹ä¸€æ¬¡æ¨±èŠ±ðŸŒ¸ã€‚å½“ä»–æå‡ºè¦æˆ‘å½“å¯¼æ¸¸çš„æ—¶å€™ï¼Œæˆ‘å¿ƒé‡Œæ˜¯ä¸‡èˆ¬ä¸ä¹æ„çš„ã€‚å¤šå¹´çš„å†…å‘æ€§æ ¼ä»¤æˆ‘æ— æ¯”æŠ—æ‹’å’Œä¸ç†Ÿæ‚‰çš„äººå¾€æ¥ã€‚ä½†æ˜¯ä»–è¯´ä½œä¸ºæŠ¥é…¬ï¼Œä¼šè¯·æˆ‘åƒé¥­ã€‚äºŽæ˜¯æˆ‘åº”é‚€äº†ã€‚ çœ‹èŠ±çš„é‚£å¤©äººå¾ˆå¤šã€‚ä»–è§åˆ°æˆ‘ï¼Œç¬¬ä¸€å¥è¯æ˜¯ï¼šâ€œæˆ‘ä»¬å¤šä¹…æ²¡è§äº†ï¼Ÿâ€æ˜¯çš„ï¼Œè‡ªä»Žå¤§ä¸€è§äº†ä¸¤ä¸‰æ¬¡ä¹‹åŽï¼Œæˆ‘ä»¬è¿™å‡ å¹´éƒ½æ²¡è§è¿‡ã€‚è™½ç„¶æˆ‘ä»¬çš„å­¦æ ¡åªéš”äº†ä¸€æ¡è¡—ã€‚é‚£å¤©æˆ‘å¾ˆæ‹˜æŸï¼ŒåŽæ¥æ…¢æ…¢èŠå¼€äº†ï¼Œé—®äº†ä»–ä¸€äº›æˆ‘åŽæ¥è§‰å¾—å¾ˆè ¢çš„é—®é¢˜ã€‚æˆ‘æ³¨æ„åˆ°ä»–å’Œå¤§å¤šæ•°çœ‹èŠ±äººä¸ä¸€æ ·ï¼Œä»–å¹¶æ²¡æœ‰å¯¹ðŸŒ¸è¡¨çŽ°å‡ºå¾ˆå¤§çš„å…´è¶£ã€‚åªæ˜¯é‚£æ—¶æˆ‘ä»¥ä¸ºï¼ŒðŸŒ¸ä¸å¤Ÿç¾Žï¼Œä¸è¶³ä»¥å¸å¼•ä»–ã€‚ 2åŽæ¥æˆ‘ä»¬çš„æ¥å¾€çªç„¶å¤šäº†èµ·æ¥ã€‚æˆ‘åŽ»çœ‹ä»–çš„ç¯®çƒèµ›ï¼Œæˆ‘ä»¬åŽ»çœ‹ç”µå½±çœ‹å¤œæ™¯ã€‚å†åˆ°åŽæ¥ï¼Œä»–çªç„¶ç‰µæˆ‘çš„æ‰‹ï¼Œæˆ‘æ…Œæ…Œå¼ å¼ æŒ£è„±ï¼Œæ‰æ˜Žç™½è¿‡æ¥ï¼Œä»–æ²¡æŠŠæˆ‘å½“å…„å¼Ÿã€‚é‚£æ®µæ—¶é—´æˆ‘ç»åŽ†äº†ç”Ÿæ´»å’Œå­¦ä¹ ä¸Šçš„ä¸€äº›æŒ«è´¥ï¼Œå¯¹äºŽä»–è¡¨çŽ°å‡ºæ¥çš„å¿ƒæ„è€ƒè™‘äº†å¾ˆå¤šã€‚çŠ¹è±«äº†å¾ˆå¤šå¤©ä¹‹åŽï¼Œåœ¨ä»–ç¬¬ä¸‰æ¬¡å°è¯•ç‰µæ‰‹çš„æ—¶å€™ï¼Œæˆ‘æ²¡æœ‰å†æŒ£è„±ã€‚ åªæ˜¯æˆ‘æ²¡æƒ³è¿‡ï¼Œæ‰€æœ‰æˆ‘ä»¥ä¸ºçš„å¶ç„¶ï¼Œä»Žæ¥éƒ½ä¸æ˜¯å¶ç„¶ã€‚ é«˜è€ƒæ”¾æ¦œä¹‹åŽå¶ç„¶é—®èµ·ä»–çš„åŽ»å‘ï¼ŒæƒŠè®¶å‘çŽ°æˆ‘ä»¬å°†è¦åŽ»å¾€åŒä¸€åº§åŸŽå¸‚ã€‚ æŸå¹´ç”Ÿæ—¥é›¶ç‚¹æ”¶åˆ°ä»–çš„çº¢åŒ…ï¼Œæˆ‘æƒŠå–œäºŽä»–ç«Ÿç„¶è®°å¾—æˆ‘çš„ç”Ÿæ—¥ã€‚ åŽæ¥ä»–è¯´ï¼Œâ€œæˆ‘å–œæ¬¢ä½ çš„æ—¶é—´ï¼Œè¦æ¯”ä½ æƒ³è±¡ä¸­é•¿å¾ˆå¤šã€‚â€ 3æ•…äº‹æ˜¯ä»–åŽæ¥å‘Šè¯‰æˆ‘çš„ã€‚ æŸå¤©æˆ‘é—®ä»–ï¼Œâ€œæˆ‘å¾ˆå¥½å¥‡ä½ æ˜¯ä»€ä¹ˆæ—¶å€™å¼€å§‹å¯¹æˆ‘æœ‰æƒ³æ³•çš„ï¼Ÿâ€ â€å¦‚æžœæ˜¯è¯´é‚£ç§æœ¦èƒ§çš„æ„Ÿæƒ…ï¼Œæˆ‘å¾ˆæ—©å°±æœ‰äº†ã€‚3æœˆä»½è§åˆ°ä½ ï¼Œå‘çŽ°ä½ è¿˜æ˜¯æˆ‘æƒ³è±¡ä¸­çš„æ ·å­ï¼Œæ‰€ä»¥ç¡®å®šäº†å†…å¿ƒçš„æƒ³æ³•ã€‚â€ ä»–è¯´ï¼Œåœ¨å¾ˆæ—©å¾ˆæ—©çš„æ—¶å€™ï¼Œä»–å¯¹æˆ‘å°±æœ‰å¾ˆæ¨¡ç³Šæœ¦èƒ§çš„æ„Ÿæƒ…ã€‚å¤§æ¦‚æ˜¯åˆä¸­æŸå¹´æˆ‘æ‰¾ä»–çˆ¬å±±çš„æ—¶å€™ï¼Ÿä»–è¯´ï¼Œâ€œæˆ‘è¿˜è®°å¾—ä½ å½“æ—¶çš„æ ·å­ï¼Œç•™ç€çŸ­å‘ï¼Œå¾ˆå¯çˆ±ã€‚â€ ä»–è¯´ï¼ŒåŽæ¥ä»–é€‰æ‹©è„±ç¦»å¤§çŽ¯å¢ƒï¼Œåˆ°å¦ä¸€ä¸ªåœ°æ–¹è¯»é«˜ä¸­ï¼Œå´ä¼šå¶å°”æƒ³èµ·æˆ‘ã€‚ ä»–è¯´ï¼Œå¤§äºŒçš„æŸä¸ªå¤œæ™šï¼Œä»–å¿ƒé‡Œå¾ˆéƒé—·ï¼Œå¤œé‡Œå‡ºæ¥èµ°èµ°ï¼Œä¸è§‰é—´èµ°åˆ°æˆ‘çš„å­¦æ ¡ã€‚æ˜Žæ˜Žæƒ³å«æˆ‘å‡ºæ¥ï¼Œå´åˆå®³æ€•çªç„¶çš„æ‰“æ‰°ï¼Œæœ€åŽåªæ˜¯éšä¾¿å¯’æš„äº†å‡ å¥ã€‚ ä»–è¯´ï¼Œå¤§å­¦æ€‚äº†å››å¹´ï¼Œç»ˆäºŽè¿ˆå‡ºä¸€æ­¥ï¼Œä»¥çœ‹èŠ±ä¸ºå€Ÿå£é è¿‘æˆ‘ï¼Œç„¶åŽçº¦æˆ‘çœ‹ç”µå½±ï¼Œç„¶åŽå°è¯•ç€ç‰µæ‰‹ï¼Œåœ¨è¢«æ‹’ç»ä¹‹åŽå¿ƒæƒ…å¾ˆä½Žè½ã€‚ä½†è¿˜æ˜¯é¼“èµ·å‹‡æ°”è¯•äº†è®¸å¤šæ¬¡ã€‚ ä»–è¿˜è¯´ï¼ŒåŽ»å¹´çœ‹åˆ°æˆ‘è¯´è¦åŽ»åŒ—äº¬ï¼Œä»–å°±ç–¯ç‹‚è”ç³»åŒ—äº¬çš„å­¦æ ¡ï¼Œåªæ˜¯å› ä¸ºç§ç§åŽŸå› æœªæˆè¡Œã€‚ â€œä»Žæˆ‘çš„å­¦æ ¡åˆ°ä½ çš„å­¦æ ¡è¿™ä¸€æ­¥ï¼Œæˆ‘èµ°äº†å››å¹´ã€‚å¾ˆåº†å¹¸ï¼Œç»ˆäºŽèµ°åˆ°äº†ã€‚â€ 4ä»–å¬ç€æŽå®—ç››çš„ã€Šé¬¼è¿·å¿ƒçªã€‹ï¼Œä¸€æ­¥ä¸€æ­¥å‘æˆ‘èµ°æ¥ã€‚åŽçŸ¥åŽè§‰çš„æˆ‘ï¼Œåº†å¹¸ç€è‡ªå·±æ˜¯è¿™ä¸ªåå¹´æ•…äº‹çš„å¥³ä¸»è§’ã€‚æœ€è¿‘å¬JJçš„æ–°æ­Œï¼Œæ„Ÿè§‰æœ‰ä¸€å¥æ­Œè¯å¾ˆé€‚åˆæ€»ç»“è¿™ç¯‡æ–‡ç« ï¼šâ€œè¿™æ•…äº‹å¼€å§‹ä¸€ä¸ªäººï¼Œæˆ‘è®¤çœŸå†™æˆäº†æˆ‘ä»¬â€ã€‚ è°¢è°¢ä½ çš„ç­‰å¾…ï¼Œè°¢è°¢ä½ çš„è®¤çœŸã€‚æœªæ¥æœ‰ä½ ï¼ŒäºŽæˆ‘å¹¸ç”šã€‚ â€‹]]></content>
      <tags>
        <tag>personal stuff</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Hello World]]></title>
    <url>%2F2019%2F09%2F27%2Fhello-world%2F</url>
    <content type="text"><![CDATA[Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub. Quick StartCreate a new post1$ hexo new "My New Post" More info: Writing Run server1$ hexo server More info: Server Generate static files1$ hexo generate More info: Generating Deploy to remote sites1$ hexo deploy More info: Deployment]]></content>
  </entry>
</search>
